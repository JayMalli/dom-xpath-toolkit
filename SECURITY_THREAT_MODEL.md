# Security Threat Model

## Assets
- **XPath Output**: Expressions generated by the toolkit that may be executed in privileged contexts.
- **User Selections**: Text and node metadata captured from active documents.
- **Build Artifacts**: Published NPM tarballs and bundled JavaScript.

## Threat Actors
- Malicious webpages attempting to coerce the toolkit into producing unsafe selectors.
- Compromised browser extensions injecting hostile DOM to hijack XPath results.
- Supply-chain attackers compromising dependencies or publishing look-alike packages.

## Trust Boundaries
- **Browser DOM**: Input surface controlled by the webpage; treat as untrusted.
- **Extension/Automation Host**: Trusted environment executing generated XPath.
- **CI/CD Pipeline**: Responsible for verifying dependencies and build outputs.

## Mitigations
- Normalize XPath output to avoid malformed expressions.
- Require explicit opt-in for non-HTTPS URL fetching in CLI (`--allow-http`).
- Enforce moderate audit level and lockfile linting (`npm run security:test`).
- Provide clear disclosure policy via `SECURITY.md`.
- Encourage sandboxing when executing XPath in privileged contexts.
- Plan for future integration with dependency monitoring tools (Dependabot, Snyk).

## Recommendations for Consumers
- Validate XPath expressions before executing them in elevated contexts.
- Avoid mixing untrusted HTML with privileged DOM operations.
- Run regular dependency audits and monitor npm advisories.
